<!DOCTYPE html><html> <head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=generator content="Docutils 0.17.1: http://docutils.sourceforge.net/"><link rel=icon href=../_static/reacnetgen.svg type=image/svg+xml><title>Simulation of the oxidation of methane &#8212; ReacNetGenerator documentation</title><!-- Loaded before other Sphinx assets --><link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel=stylesheet><link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel=stylesheet><link rel=stylesheet href=../_static/vendor/fontawesome/5.13.0/css/all.min.css><link rel=preload as=font type=font/woff2 crossorigin href=../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2><link rel=preload as=font type=font/woff2 crossorigin href=../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2><link rel=stylesheet type=text/css href=../_static/pygments.css><link rel=stylesheet href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type=text/css><link rel=stylesheet type=text/css href=../_static/css/custom.css><!-- Pre-loaded scripts that we'll load fully later --><link rel=preload as=script href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"><script data-url_root=../ id=documentation_options src=../_static/documentation_options.js></script><script src=../_static/jquery.js></script><script src=../_static/underscore.js></script><script src=../_static/doctools.js></script><script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script><script src=https://unpkg.com/bilitube@0/dist/bilitube.min.js></script><link rel=index title=Index href=../genindex.html><link rel=search title=Search href=../search.html><link rel=next title="The thermal decomposition of CL-20 (C6H6N12O12)" href=cl20.html><link rel=prev title="Tutorials and Applications" href=index.html><meta name=viewport content="width=device-width, initial-scale=1"><meta name=docsearch:language content=None><!-- Google Analytics --></head> <body data-spy=scroll data-target=#bd-toc-nav data-offset=60> <!-- Checkboxes to toggle the left sidebar --> <input type=checkbox class=sidebar-toggle name=__navigation id=__navigation aria-label="Toggle navigation sidebar"> <label class="overlay overlay-navbar" for=__navigation> <div class=visually-hidden>Toggle navigation sidebar</div> </label> <!-- Checkboxes to toggle the in-page toc --> <input type=checkbox class=sidebar-toggle name=__page-toc id=__page-toc aria-label="Toggle in-page Table of Contents"> <label class="overlay overlay-pagetoc" for=__page-toc> <div class=visually-hidden>Toggle in-page Table of Contents</div> </label> <!-- Headers at the top --> <div class="announcement header-item noprint"></div> <div class="header header-item noprint"></div> <div class=container-fluid id=banner></div> <div class=container-xl> <div class=row> <!-- Sidebar --> <div class="bd-sidebar noprint" id=site-navigation> <div class=bd-sidebar__content> <div class=bd-sidebar__top><div class=navbar-brand-box> <a class="navbar-brand text-wrap" href=../index.html> <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 --> <img src=../_static/reacnetgen.svg class=logo alt=logo> <h1 class=site-logo id=site-title>ReacNetGenerator documentation</h1> </a> </div><form class="bd-search d-flex align-items-center" action=../search.html method=get> <i class="icon fas fa-search"></i> <input type=search class=form-control name=q id=search-input placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete=off> </form><nav class=bd-links id=bd-docs-nav aria-label=Main> <div class="bd-toc-item active"> <ul class="nav bd-sidenav bd-sidenav__home-link"> <li class=toctree-l1> <a class="reference internal" href=../index.html> ReacNetGenerator </a> </li> </ul> <ul class="current nav bd-sidenav"> <li class="toctree-l1 has-children"> <a class="reference internal" href=../guide/index.html> Guides </a> <input class=toctree-checkbox id=toctree-checkbox-1 name=toctree-checkbox-1 type=checkbox> <label for=toctree-checkbox-1> <i class="fas fa-chevron-down"> </i> </label> <ul> <li class=toctree-l2> <a class="reference internal" href=../guide/install.html> Installation </a> </li> <li class=toctree-l2> <a class="reference internal" href=../guide/build.html> Build ReacNetGenerator </a> </li> <li class=toctree-l2> <a class="reference internal" href=../guide/cli.html> Command line interface </a> </li> <li class=toctree-l2> <a class="reference internal" href=../guide/hmm.html> Enable HMM filter </a> </li> <li class=toctree-l2> <a class="reference internal" href=../guide/gui.html> GUI version </a> </li> <li class=toctree-l2> <a class="reference internal" href=../guide/python.html> Python interface </a> </li> </ul> </li> <li class="toctree-l1 current active has-children"> <a class="reference internal" href=index.html> Tutorials and Applications </a> <input checked class=toctree-checkbox id=toctree-checkbox-2 name=toctree-checkbox-2 type=checkbox> <label for=toctree-checkbox-2> <i class="fas fa-chevron-down"> </i> </label> <ul class=current> <li class="toctree-l2 current active"> <a class="current reference internal" href=#> Simulation of the oxidation of methane </a> </li> <li class=toctree-l2> <a class="reference internal" href=cl20.html> The thermal decomposition of CL-20 (C <sub> 6 </sub> H <sub> 6 </sub> N <sub> 12 </sub> O <sub> 12 </sub> ) </a> </li> </ul> </li> <li class="toctree-l1 has-children"> <a class="reference internal" href=../develop.html> Developing </a> <input class=toctree-checkbox id=toctree-checkbox-3 name=toctree-checkbox-3 type=checkbox> <label for=toctree-checkbox-3> <i class="fas fa-chevron-down"> </i> </label> <ul> <li class="toctree-l2 has-children"> <a class="reference internal" href=../api/api.html> Python API </a> <input class=toctree-checkbox id=toctree-checkbox-4 name=toctree-checkbox-4 type=checkbox> <label for=toctree-checkbox-4> <i class="fas fa-chevron-down"> </i> </label> <ul> <li class=toctree-l3> <a class="reference internal" href=../api/reacnetgenerator.html> reacnetgenerator package </a> </li> </ul> </li> </ul> </li> <li class="toctree-l1 has-children"> <a class="reference internal" href=../external.html> External resources </a> <input class=toctree-checkbox id=toctree-checkbox-5 name=toctree-checkbox-5 type=checkbox> <label for=toctree-checkbox-5> <i class="fas fa-chevron-down"> </i> </label> <ul> <li class=toctree-l2> <a class="reference external" href=https://doi.org/10.1039/C9CP05091D> ReacNetGenerator paper </a> </li> <li class=toctree-l2> <a class="reference external" href="https://scholarship.libraries.rutgers.edu/view/pdfCoverPage?instCode=01RUT_INST&filePid=13678734780004646&download=true"> Accepted manuscript </a> </li> <li class=toctree-l2> <a class="reference external" href=https://github.com/tongzhugroup/reacnetgenerator> GitHub </a> </li> <li class=toctree-l2> <a class="reference external" href=https://computchem.cn> Research group </a> </li> </ul> </li> </ul> </div> </nav></div> <div class=bd-sidebar__bottom> <!-- To handle the deprecated key --> <div class=navbar_extra_footer> Theme by the <a href=https://ebp.jupyterbook.org>Executable Book Project</a> </div> </div> </div> <div id=rtd-footer-container></div> </div> <!-- A tiny helper pixel to detect if we've scrolled --> <div class=sbt-scroll-pixel-helper></div> <!-- Main content --> <div class="col py-0 content-container"> <div class="header-article row sticky-top noprint"> <div class="col py-1 d-flex header-article-main"> <div class=header-article__left> <label for=__navigation class=headerbtn data-toggle=tooltip data-placement=right title="Toggle navigation"> <span class=headerbtn__icon-container> <i class="fas fa-bars"></i> </span> </label> </div> <div class=header-article__right> <button onclick=toggleFullScreen() class=headerbtn data-toggle=tooltip data-placement=bottom title="Fullscreen mode"> <span class=headerbtn__icon-container> <i class="fas fa-expand"></i> </span> </button> <div class="menu-dropdown menu-dropdown-repository-buttons"> <button class="headerbtn menu-dropdown__trigger" aria-label="Source repositories"> <i class="fab fa-github"></i> </button> <div class=menu-dropdown__content> <ul> <li> <a href=https://github.com/tongzhugroup/reacnetgenerator class=headerbtn data-toggle=tooltip data-placement=left title="Source repository"> <span class=headerbtn__icon-container> <i class="fab fa-github"></i> </span> <span class=headerbtn__text-container>repository</span> </a> </li> <li> <a href="https://github.com/tongzhugroup/reacnetgenerator/issues/new?title=Issue%20on%20page%20%2Ftutorial/methane.html&body=Your%20issue%20content%20here." class=headerbtn data-toggle=tooltip data-placement=left title="Open an issue"> <span class=headerbtn__icon-container> <i class="fas fa-lightbulb"></i> </span> <span class=headerbtn__text-container>open issue</span> </a> </li> <li> <a href=https://github.com/tongzhugroup/reacnetgenerator/edit/master/docs/tutorial/methane.md class=headerbtn data-toggle=tooltip data-placement=left title="Edit this page"> <span class=headerbtn__icon-container> <i class="fas fa-pencil-alt"></i> </span> <span class=headerbtn__text-container>suggest edit</span> </a> </li> </ul> </div> </div> <div class="menu-dropdown menu-dropdown-download-buttons"> <button class="headerbtn menu-dropdown__trigger" aria-label="Download this page"> <i class="fas fa-download"></i> </button> <div class=menu-dropdown__content> <ul> <li> <a href=../_sources/tutorial/methane.md.txt class=headerbtn data-toggle=tooltip data-placement=left title="Download source file"> <span class=headerbtn__icon-container> <i class="fas fa-file"></i> </span> <span class=headerbtn__text-container>.md</span> </a> </li> <li> <button onclick=printPdf(this) class=headerbtn data-toggle=tooltip data-placement=left title="Print to PDF"> <span class=headerbtn__icon-container> <i class="fas fa-file-pdf"></i> </span> <span class=headerbtn__text-container>.pdf</span> </button> </li> </ul> </div> </div> <label for=__page-toc class="headerbtn headerbtn-page-toc"> <span class=headerbtn__icon-container> <i class="fas fa-list"></i> </span> </label> </div> </div> <!-- Table of contents --> <div class="col-md-3 bd-toc show noprint"> <div class="tocsection onthispage pt-5 pb-3"> <i class="fas fa-list"></i> Contents </div> <nav id=bd-toc-nav aria-label=Page> <ul class="visible nav section-nav flex-column"> <li class="toc-h2 nav-item toc-entry"> <a class="reference internal nav-link" href=#step-1-preparing-the-reference-dataset> Step 1: Preparing the reference dataset </a> </li> <li class="toc-h2 nav-item toc-entry"> <a class="reference internal nav-link" href=#step-2-training-the-deep-potential-dp> Step 2. Training the Deep Potential (DP) </a> </li> <li class="toc-h2 nav-item toc-entry"> <a class="reference internal nav-link" href=#step-3-freeze-the-model> Step 3: Freeze the model </a> </li> <li class="toc-h2 nav-item toc-entry"> <a class="reference internal nav-link" href=#step-4-running-md-simulation-based-on-the-dp> Step 4: Running MD simulation based on the DP </a> </li> <li class="toc-h2 nav-item toc-entry"> <a class="reference internal nav-link" href=#step-5-analysis-of-the-trajectory> Step 5: Analysis of the trajectory </a> </li> <li class="toc-h2 nav-item toc-entry"> <a class="reference internal nav-link" href=#acknowledge> Acknowledge </a> </li> <li class="toc-h2 nav-item toc-entry"> <a class="reference internal nav-link" href=#references> References </a> </li> </ul> </nav> </div> </div> <div class="article row"> <div class="col pl-md-3 pl-lg-5 content-container"> <!-- Table of contents that is only displayed when printing the page --> <div id=jb-print-docs-body class=onlyprint> <h1>Simulation of the oxidation of methane</h1> <!-- Table of contents --> <div id=print-main-content> <div id=jb-print-toc> <div> <h2> Contents </h2> </div> <nav aria-label=Page> <ul class="visible nav section-nav flex-column"> <li class="toc-h2 nav-item toc-entry"> <a class="reference internal nav-link" href=#step-1-preparing-the-reference-dataset> Step 1: Preparing the reference dataset </a> </li> <li class="toc-h2 nav-item toc-entry"> <a class="reference internal nav-link" href=#step-2-training-the-deep-potential-dp> Step 2. Training the Deep Potential (DP) </a> </li> <li class="toc-h2 nav-item toc-entry"> <a class="reference internal nav-link" href=#step-3-freeze-the-model> Step 3: Freeze the model </a> </li> <li class="toc-h2 nav-item toc-entry"> <a class="reference internal nav-link" href=#step-4-running-md-simulation-based-on-the-dp> Step 4: Running MD simulation based on the DP </a> </li> <li class="toc-h2 nav-item toc-entry"> <a class="reference internal nav-link" href=#step-5-analysis-of-the-trajectory> Step 5: Analysis of the trajectory </a> </li> <li class="toc-h2 nav-item toc-entry"> <a class="reference internal nav-link" href=#acknowledge> Acknowledge </a> </li> <li class="toc-h2 nav-item toc-entry"> <a class="reference internal nav-link" href=#references> References </a> </li> </ul> </nav> </div> </div> </div> <main id=main-content role=main> <div> <section id=simulation-of-the-oxidation-of-methane> <h1>Simulation of the oxidation of methane<a class=headerlink href=#simulation-of-the-oxidation-of-methane title="Permalink to this headline">#</a></h1> <p>Jinzhe Zeng, Liqun Cao, and Tong Zhu</p> <p>This tutorial was adapted from: Jinzhe Zeng, Liqun Cao, Tong Zhu (2022), Neural network potentials, Pavlo O. Dral (Eds.), <em>Quantum Chemistry in the Age of Machine Learning</em>, Elsevier. Please cite the above chapter if you follow the tutorial.</p> <hr class=docutils> <p>In this tutorial, we will take the simulation of methane combustion as an example. All files needed in this section can be downloaded from <a class="reference external" href=https://github.com/tongzhugroup/Chapter13-tutorial>tongzhugroup/Chapter13-tutorial</a>. Besides ReacNetGenerator, DeePMD-kit (with LAMMPS) will be used to run simulations.</p> <section id=step-1-preparing-the-reference-dataset> <h2>Step 1: Preparing the reference dataset<a class=headerlink href=#step-1-preparing-the-reference-dataset title="Permalink to this headline">#</a></h2> <p>In the reference dataset preparation process, one also has to consider the expect accuracy of the final model, or at what QM level one should label the data. In <a class="reference external" href=https://doi.org/10.1038/s41467-020-19497-z>this paper</a>, the <a class="reference external" href=https://gaussian.com>Gaussian</a> software was used to calculate the potential energy and atomic forces of the reference data at the MN15/6-31G** level. The MN15 functional was employed because it has good accuracy for both multi-reference and single-reference systems, which is essential for our system as we have to deal with a lot of radicals and their reactions. Here we assume that the dataset is prepared in advance, which can be downloaded from <a class="reference external" href=https://github.com/tongzhugroup/Chapter13-tutorial>tongzhugroup/Chapter13-tutorial</a>.</p> </section> <section id=step-2-training-the-deep-potential-dp> <h2>Step 2. Training the Deep Potential (DP)<a class=headerlink href=#step-2-training-the-deep-potential-dp title="Permalink to this headline">#</a></h2> <p>Before the training process, we need to prepare an input file called <code class="docutils literal notranslate"><span class=pre>methane_param.json</span></code> which contains the control parameters. The training can be done by the following command:</p> <div class="highlight-sh notranslate"><div class=highlight><pre><span></span><span class=nv>$deepmd_root</span>/bin/dp train methane_param.json
</pre></div> </div> <p>There are several parameters we need to define in the <code class="docutils literal notranslate"><span class=pre>methane_param.json</span></code> file. The type_map refers to the type of elements included in the training, and the option of rcut is the cut-off radius which controls the description of the environment around the center atom. The type of descriptor is <code class="docutils literal notranslate"><span class=pre>se_a</span></code> in this example, which represents the DeepPot-SE model. The descriptor will decay smoothly from rcut_smth (R_on) to the cut-off radius rcut (R_off). Here rcut_smth and rcut are set to 1.0 Å and 6.0 Å respectively. The sel defines the maximum possible number of neighbors for the corresponding element within the cut-off radius. The options neuron in descriptor and fitting_net is used to determine the shape of the embedding neural network and the fitting network, which are set to (25, 50, 100) and (240, 240, 240) respectively. The value of <code class="docutils literal notranslate"><span class=pre>axis_neuron</span></code> represents the size of the embedding matrix, which was set to 12.</p> </section> <section id=step-3-freeze-the-model> <h2>Step 3: Freeze the model<a class=headerlink href=#step-3-freeze-the-model title="Permalink to this headline">#</a></h2> <p>This step is to extract the trained neural network model. To freeze the model, the following command will be executed:</p> <div class="highlight-sh notranslate"><div class=highlight><pre><span></span><span class=nv>$deepmd_root</span>/bin/dp freeze -o graph.pb
</pre></div> </div> <p>A file called <code class="docutils literal notranslate"><span class=pre>graph.pb</span></code> can be found in the training folder. Then the frozen model can be compressed:</p> <div class="highlight-sh notranslate"><div class=highlight><pre><span></span><span class=nv>$deepmd_root</span>/bin/dp compress -i graph.pb -o graph_compressed.pb -t methane_param.json
</pre></div> </div> </section> <section id=step-4-running-md-simulation-based-on-the-dp> <h2>Step 4: Running MD simulation based on the DP<a class=headerlink href=#step-4-running-md-simulation-based-on-the-dp title="Permalink to this headline">#</a></h2> <p>The frozen model can be used to run reactive MD simulations to explore the detailed reaction mechanism of methane combustion. The MD engine is provided by the <a class="reference external" href=https://github.com/lammps/lammps>LAMMPS</a> software. Here we use the same system from <a class="reference external" href=https://doi.org/10.1038/s41467-020-19497-z>our previous work</a>, which contains 100 methane and 200 oxygen molecules. The MD will be performed under the NVT ensemble at 3000 K for 1 ns. The LAMMPS program can be invoked by the following command:</p> <div class="highlight-sh notranslate"><div class=highlight><pre><span></span><span class=nv>$deepmd_root</span>/bin/lmp -i input.lammps 
</pre></div> </div> <p>The <code class="docutils literal notranslate"><span class=pre>input.lammps</span></code> is the input file that controls the MD simulation in detail, technique details can be found in <a href=https://docs.lammps.org/ class="reference external">the manual of LAMMPS</a>. To use the DP, the pair_style option in this input should be specified as follows:</p> <div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=n>pair_style</span> <span class=n>deepmd</span> <span class=n>graph_compressed</span><span class=o>.</span><span class=n>pb</span> 
<span class=n>pair_coeff</span> <span class=o>*</span> <span class=o>*</span> 
</pre></div> </div> </section> <section id=step-5-analysis-of-the-trajectory> <h2>Step 5: Analysis of the trajectory<a class=headerlink href=#step-5-analysis-of-the-trajectory title="Permalink to this headline">#</a></h2> <p>After the simulation is done, we can use the ReacNetGenerator software which was developed in our previous study to extract the reaction network from the trajectory. All species and reactions in the trajectory will be put on an interactive web page where we can analyze them by mouse clicks. Eventually we should be able to obtain reaction networks that consistent with the following figure.</p> <div class="highlight-sh notranslate"><div class=highlight><pre><span></span>reacnetgenerator -i methane.lammpstrj -a C H O --dump
</pre></div> </div> <p><img alt="The initial stage of combustion" src="https://media.springernature.com/full/springer-static/image/art%3A10.1038%2Fs41467-020-19497-z/MediaObjects/41467_2020_19497_Fig2_HTML.png?as=webp"></p> <p>Fig: The initial stage of combustion. The figure is taken from <a class="reference external" href=https://doi.org/10.1038/s41467-020-19497-z>this paper</a> and more results can be found there.</p> </section> <hr class=docutils> <section id=acknowledge> <h2>Acknowledge<a class=headerlink href=#acknowledge title="Permalink to this headline">#</a></h2> <p>This work was supported by the National Natural Science Foundation of China (Grants No. 22173032, 21933010). J.Z. was supported in part by the National Institutes of Health (GM107485) under the direction of Darrin M. York. We also thank the ECNU Multifunctional Platform for Innovation (No. 001) and the Extreme Science and Engineering Discovery Environment (XSEDE), which is supported by National Science Foundation Grant ACI-1548562.56 (specifically, the resources EXPANSE at SDSC through allocation TG-CHE190067), for providing supercomputer time.</p> </section> <section id=references> <h2>References<a class=headerlink href=#references title="Permalink to this headline">#</a></h2> <ol class="arabic simple"> <li><p>Jinzhe Zeng, Liqun Cao, Tong Zhu (2022), Neural network potentials, Pavlo O. Dral (Eds.), <em>Quantum Chemistry in the Age of Machine Learning</em>, Elsevier.</p></li> <li><p>Jinzhe Zeng, Liqun Cao, Mingyuan Xu, Tong Zhu, John Z. H. Zhang, Complex reaction processes in combustion unraveled by neural network-based molecular dynamics simulation, Nature Communications, 2020, 11, 5713.</p></li> <li><p>Frisch, M.; Trucks, G.; Schlegel, H.; Scuseria, G.; Robb, M.; Cheeseman, J.; Scalmani, G.; Barone, V.; Petersson, G.; Nakatsuji, H., Gaussian 16, revision A. 03. Gaussian Inc., Wallingford CT 2016.</p></li> <li><p>Han Wang, Linfeng Zhang, Jiequn Han, Weinan E, DeePMD-kit: A deep learning package for many-body potential energy representation and molecular dynamics, Computer Physics Communications, 2018, 228, 178-184.</p></li> <li><p>Aidan P. Thompson, H. Metin Aktulga, Richard Berger, Dan S. Bolintineanu, W. Michael Brown, Paul S. Crozier, Pieter J. in ‘t Veld, Axel Kohlmeyer, Stan G. Moore, Trung Dac Nguyen, Ray Shan, Mark J. Stevens, Julien Tranchida, Christian Trott, Steven J. Plimpton, LAMMPS - a flexible simulation tool for particle-based materials modeling at the atomic, meso, and continuum scales, Computer Physics Communications, 2022, 271, 108171.</p></li> <li><p>Denghui Lu, Wanrun Jiang, Yixiao Chen, Linfeng Zhang, Weile Jia, Han Wang, Mohan Chen, DP Train, then DP Compress: Model Compression in Deep Potential Molecular Dynamics, 2021.</p></li> <li><p>Jinzhe Zeng, Liqun Cao, Chih-Hao Chin, Haisheng Ren, John Z. H. Zhang, Tong Zhu, ReacNetGenerator: an automatic reaction network generator for reactive molecular dynamics simulations, Phys. Chem. Chem. Phys., 2020, 22 (2), 683–691.</p></li> </ol> </section> </section> </div> </main> <footer class="footer-article noprint"> <!-- Previous / next buttons --> <div class=prev-next-area> <a class=left-prev id=prev-link href=index.html title="previous page"> <i class="fas fa-angle-left"></i> <div class=prev-next-info> <p class=prev-next-subtitle>previous</p> <p class=prev-next-title>Tutorials and Applications</p> </div> </a> <a class=right-next id=next-link href=cl20.html title="next page"> <div class=prev-next-info> <p class=prev-next-subtitle>next</p> <p class=prev-next-title>The thermal decomposition of CL-20 (C<sub>6</sub>H<sub>6</sub>N<sub>12</sub>O<sub>12</sub>)</p> </div> <i class="fas fa-angle-right"></i> </a> </div> </footer> </div> </div> <div class="footer-content row"> <footer class="col footer"><p> By Jinzhe Zeng<br> &copy; Copyright 2019-2022, East China Normal University.<br> </p> </footer> </div> </div> </div> </div> <!-- Scripts loaded after <body> so the DOM is not blocked --> <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script> </body> </html>