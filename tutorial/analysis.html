<!DOCTYPE html><html lang=en> <head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=generator content="Docutils 0.19.1b.dev: https://docutils.sourceforge.io/"><link rel=icon href=../_static/reacnetgen.svg type=image/svg+xml><title>Tutorial: Analysis &#8212; ReacNetGenerator documentation</title><script>
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script><!-- Loaded before other Sphinx assets --><link href="../_static/styles/theme.css?digest=1e1de1a1873e13ef5536" rel=stylesheet><link href="../_static/styles/pydata-sphinx-theme.css?digest=1e1de1a1873e13ef5536" rel=stylesheet><link rel=stylesheet href=../_static/vendor/fontawesome/6.1.2/css/all.min.css><link rel=preload as=font type=font/woff2 crossorigin href=../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2><link rel=preload as=font type=font/woff2 crossorigin href=../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2><link rel=preload as=font type=font/woff2 crossorigin href=../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2><link rel=stylesheet type=text/css href=../_static/pygments.css><link rel=stylesheet type=text/css href=../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css><link rel=stylesheet type=text/css href=../_static/css/custom.css><!-- Pre-loaded scripts that we'll load fully later --><link rel=preload as=script href="../_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536"><script data-url_root=../ id=documentation_options src=../_static/documentation_options.js></script><script src=../_static/jquery.js></script><script src=../_static/underscore.js></script><script src=../_static/_sphinx_javascript_frameworks_compat.js></script><script src=../_static/doctools.js></script><script src=../_static/sphinx_highlight.js></script><script>DOCUMENTATION_OPTIONS.pagename = 'tutorial/analysis';</script><script src=https://unpkg.com/bilitube@0/dist/bilitube.min.js></script><link rel=index title=Index href=../genindex.html><link rel=search title=Search href=../search.html><link rel=next title="Simulation of the oxidation of methane" href=methane.html><link rel=prev title="Tutorial: Installation" href=install.html><meta name=viewport content="width=device-width, initial-scale=1"><meta name=docsearch:language content=en></head> <body data-spy=scroll data-target=#bd-toc-nav data-offset=180 data-default-mode> <input type=checkbox class=sidebar-toggle name=__primary id=__primary> <label class="overlay overlay-primary" for=__primary></label> <input type=checkbox class=sidebar-toggle name=__secondary id=__secondary> <label class="overlay overlay-secondary" for=__secondary></label> <div class=search-button__wrapper> <div class=search-button__overlay></div> <div class=search-button__search-container> <form class="bd-search d-flex align-items-center" action=../search.html method=get> <i class="fa-solid fa-magnifying-glass"></i> <input type=search class=form-control name=q id=search-input placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete=off autocorrect=off autocapitalize=off spellcheck=false> <span class=search-button__kbd-shortcut><kbd class=kbd-shortcut__modifier>Ctrl</kbd>+<kbd>K</kbd></span> </form> </div> </div> <nav class="bd-header navbar navbar-expand-lg bd-navbar" id=navbar-main><div class="bd-header__inner bd-page-width"> <label class="sidebar-toggle primary-toggle" for=__primary> <span class="fa-solid fa-bars"></span> </label> <div id=navbar-start> <a class="navbar-brand logo" href=../index.html> <img src=../_static/reacnetgen.svg class="logo__image only-light" alt=ReacNetGenerator> <img src=../_static/reacnetgen.svg class="logo__image only-dark" alt=ReacNetGenerator> <p class="title logo__title">ReacNetGenerator</p> </a> </div> <div class="col-lg-9 navbar-header-items"> <div id=navbar-center class=mr-auto> <div class=navbar-center-item> <nav class=navbar-nav> <p class=sidebar-header-items__title role=heading aria-level=1 aria-label="Site Navigation"> Site Navigation </p> <ul id=navbar-main-elements class=navbar-nav> <li class=nav-item> <a class=nav-link href=../guide/index.html> User Guide </a> </li> <li class="nav-item current active"> <a class=nav-link href=index.html> Examples </a> </li> <li class=nav-item> <a class=nav-link href=../develop.html> Development </a> </li> <li class=nav-item> <a class=nav-link href=../external.html> More </a> </li> <li class=nav-item> <a class="nav-link nav-external" href=/report.html>Report Loader<i class="fa-solid fa-up-right-from-square"></i></a> </li> </ul> </nav> </div> </div> <div id=navbar-end> <div class="navbar-end-item navbar-end__search-button-container"> <button class="btn btn-sm navbar-btn search-button search-button__button" title=Search data-toggle=tooltip> <i class="fa-solid fa-magnifying-glass"></i> </button> </div> <div class=navbar-end-item> <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title=light/dark data-toggle=tooltip> <a class=theme-switch data-mode=light><i class="fa-solid fa-sun"></i></a> <a class=theme-switch data-mode=dark><i class="fa-regular fa-moon"></i></a> <a class=theme-switch data-mode=auto><i class="fa-solid fa-circle-half-stroke"></i></a> </span> </div> <div class=navbar-end-item> <ul id=navbar-icon-links class=navbar-nav aria-label="Icon Links"> <li class=nav-item> <a href=https://github.com/tongzhugroup/reacnetgenerator title=GitHub class=nav-link rel=noopener target=_blank data-toggle=tooltip><span><i class="fa-brands fa-square-github"></i></span> <label class=sr-only>GitHub</label></a> </li> <li class=nav-item> <a href=https://doi.org/10.1039/C9CP05091D title=Paper class=nav-link rel=noopener target=_blank data-toggle=tooltip><span><i class="fa-solid fa-book-open"></i></span> <label class=sr-only>Paper</label></a> </li> </ul> </div> </div> </div> <div class=search-button-container--mobile> <button class="btn btn-sm navbar-btn search-button search-button__button" title=Search data-toggle=tooltip> <i class="fa-solid fa-magnifying-glass"></i> </button> </div> <label class="sidebar-toggle secondary-toggle" for=__secondary> <span class="fa-solid fa-outdent"></span> </label> </div> </nav> <div class=bd-container> <div class="bd-container__inner bd-page-width"> <div class="bd-sidebar-primary bd-sidebar"> <div class="sidebar-header-items sidebar-primary__section"> <div class=sidebar-header-items__center> <div class=navbar-center-item> <nav class=navbar-nav> <p class=sidebar-header-items__title role=heading aria-level=1 aria-label="Site Navigation"> Site Navigation </p> <ul id=navbar-main-elements class=navbar-nav> <li class=nav-item> <a class=nav-link href=../guide/index.html> User Guide </a> </li> <li class="nav-item current active"> <a class=nav-link href=index.html> Examples </a> </li> <li class=nav-item> <a class=nav-link href=../develop.html> Development </a> </li> <li class=nav-item> <a class=nav-link href=../external.html> More </a> </li> <li class=nav-item> <a class="nav-link nav-external" href=/report.html>Report Loader<i class="fa-solid fa-up-right-from-square"></i></a> </li> </ul> </nav> </div> </div> <div class=sidebar-header-items__end> <div class=navbar-end-item> <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title=light/dark data-toggle=tooltip> <a class=theme-switch data-mode=light><i class="fa-solid fa-sun"></i></a> <a class=theme-switch data-mode=dark><i class="fa-regular fa-moon"></i></a> <a class=theme-switch data-mode=auto><i class="fa-solid fa-circle-half-stroke"></i></a> </span> </div> <div class=navbar-end-item> <ul id=navbar-icon-links class=navbar-nav aria-label="Icon Links"> <li class=nav-item> <a href=https://github.com/tongzhugroup/reacnetgenerator title=GitHub class=nav-link rel=noopener target=_blank data-toggle=tooltip><span><i class="fa-brands fa-square-github"></i></span> <label class=sr-only>GitHub</label></a> </li> <li class=nav-item> <a href=https://doi.org/10.1039/C9CP05091D title=Paper class=nav-link rel=noopener target=_blank data-toggle=tooltip><span><i class="fa-solid fa-book-open"></i></span> <label class=sr-only>Paper</label></a> </li> </ul> </div> </div> </div> <div class="sidebar-start-items sidebar-primary__section"> <div class=sidebar-start-items__item><nav class=bd-links id=bd-docs-nav aria-label="Section navigation"> <p class=bd-links__title role=heading aria-level=1> Section Navigation </p> <div class="bd-toc-item navbar-nav"> <p aria-level=2 class=caption role=heading><span class=caption-text>Tutorials</span></p> <ul class="current nav bd-sidenav"> <li class=toctree-l1><a class="reference internal" href=install.html>Tutorial: Installation</a></li> <li class="toctree-l1 current active"><a class="current reference internal" href=#>Tutorial: Analysis</a></li> </ul> <p aria-level=2 class=caption role=heading><span class=caption-text>Case Studies</span></p> <ul class="nav bd-sidenav"> <li class=toctree-l1><a class="reference internal" href=methane.html>Simulation of the oxidation of methane</a></li> <li class=toctree-l1><a class="reference internal" href=cl20.html>The thermal decomposition of CL-20 (C<sub>6</sub>H<sub>6</sub>N<sub>12</sub>O<sub>12</sub>)</a></li> </ul> <p aria-level=2 class=caption role=heading><span class=caption-text>Publications</span></p> <ul class="nav bd-sidenav"> <li class=toctree-l1><a href=http://njzjz.win/reacnetgenerator/ class="reference external">Publications driven by ReacNetGenerator</a></li> </ul> </div> </nav> </div> </div> <div class="sidebar-end-items sidebar-primary__section"> <div class=sidebar-end-items__item> </div> </div> </div> <main class=bd-main> <div class=bd-content> <div class=bd-article-container> <div class=bd-header-article> </div> <article class=bd-article role=main> <section class="tex2jax_ignore mathjax_ignore" id=tutorial-analysis> <h1>Tutorial: Analysis<a class=headerlink href=#tutorial-analysis title="Permalink to this heading">#</a></h1> <p>In this tutorial, we analyze a simple trajectroy as an example. The trajectory is taken from the real case <a class="reference internal" href=cl20.html><span class="doc std std-doc">the thermal decomposition of CL-20</span></a>.</p> <p>Download this trajectory using <code class="docutils literal notranslate"><span class=pre>wget</span></code>:</p> <div class="cell docutils container"> <div class="cell_input docutils container"> <div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=o>%%</span><span class=n>bash</span>
<span class=n>wget</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>raw</span><span class=o>.</span><span class=n>githubusercontent</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>tongzhugroup</span><span class=o>/</span><span class=n>TRAJREAX</span><span class=o>/</span><span class=n>f10a5c2cab77d3f3b659d9dd08256ae7b27c2820</span><span class=o>/</span><span class=n>cl20</span><span class=o>/</span><span class=n>cl20</span><span class=o>.</span><span class=n>lammpstrj</span> <span class=o>-</span><span class=n>O</span> <span class=n>cl20</span><span class=o>.</span><span class=n>lammpstrj</span>
</pre></div> </div> </div> <div class="cell_output docutils container"> <div class="output stderr highlight-myst-ansi notranslate"><div class=highlight><pre><span></span>--2022-11-05 08:51:40--  https://raw.githubusercontent.com/tongzhugroup/TRAJREAX/f10a5c2cab77d3f3b659d9dd08256ae7b27c2820/cl20/cl20.lammpstrj
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.109.133, 185.199.110.133, 185.199.111.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.109.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 920127 (899K) [text/plain]
Saving to: ‘cl20.lammpstrj’

     0K .......... .......... .......... .......... ..........  5% 4.24M 0s
    50K .......... .......... .......... .......... .......... 11% 5.15M 0s
   100K .......... .......... .......... .......... .......... 16% 24.7M 0s
   150K .......... .......... .......... .......... .......... 22% 20.2M 0s
   200K .......... .......... .......... .......... .......... 27% 7.99M 0s
   250K .......... .......... .......... .......... .......... 33% 42.7M 0s
   300K .......... .......... .......... .......... .......... 38% 38.7M 0s
   350K .......... .......... .......... .......... .......... 44% 40.9M 0s
   400K .......... .......... .......... .......... .......... 50% 54.6M 0s
   450K .......... .......... .......... .......... .......... 55% 58.8M 0s
   500K .......... .......... .......... .......... .......... 61% 9.66M 0s
   550K .......... .......... .......... .......... .......... 66% 45.7M 0s
   600K .......... .......... .......... .......... .......... 72% 38.5M 0s
   650K .......... .......... .......... .......... .......... 77% 80.2M 0s
   700K .......... .......... .......... .......... .......... 83% 70.4M 0s
   750K .......... .......... .......... .......... .......... 89% 68.7M 0s
   800K .......... .......... .......... .......... .......... 94% 67.0M 0s
   850K .......... .......... .......... .......... ........  100% 79.9M=0.05s

2022-11-05 08:51:41 (18.5 MB/s) - ‘cl20.lammpstrj’ saved [920127/920127]
</pre></div> </div> </div> </div> <p>Then use <code class="docutils literal notranslate"><span class=pre>reacnetgenerator</span></code> to analyze it. Note the order of elements (<code class="docutils literal notranslate"><span class=pre>H</span> <span class=pre>C</span> <span class=pre>N</span> <span class=pre>O</span></code>) MUST map to those in the trajectory.</p> <div class="cell docutils container"> <div class="cell_input docutils container"> <div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=o>%%</span><span class=n>bash</span>
<span class=n>reacnetgenerator</span> <span class=o>-</span><span class=n>i</span> <span class=n>cl20</span><span class=o>.</span><span class=n>lammpstrj</span> <span class=o>-</span><span class=n>a</span> <span class=n>H</span> <span class=n>C</span> <span class=n>N</span> <span class=n>O</span> <span class=o>--</span><span class=nb>type</span> <span class=n>dump</span> <span class=o>--</span><span class=n>nohmm</span>
</pre></div> </div> </div> <div class="cell_output docutils container"> <div class="output stderr highlight-myst-ansi notranslate"><div class=highlight><pre><span></span>2022-11-05 08:51:46,154 - ReacNetGenerator 1.6.6.dev24+g068dac4 - INFO: ReacNetGenerator: an automatic reaction network generator for reactive
molecular dynamics simulation.

Please cite: ReacNetGenerator: an automatic reaction network generator
for reactive molecular dynamic simulations, Phys. Chem. Chem. Phys.,
2020, 22 (2): 683-691, doi: 10.1039/C9CP05091D

Jinzhe Zeng (jinzhe.zeng@rutgers.edu), Tong Zhu (tzhu@lps.ecnu.edu.cn)

==================
Features
==================
* Processing of MD trajectory containing atomic coordinates or bond orders
* Hidden Markov Model (HMM) based noise filtering
* Isomers identifying accoarding to SMILES
* Generation of reaction network for visualization using force-directed
  algorithm
* Parallel computing

==================
Simple example
==================
ReacNetGenerator can process any kind of trajectory files containing 
atomic coordinates, e.g. a LAMMPS dump file prepared by running “dump 1
all custom 100 dump.reaxc id type x y z” in LAMMPS:
$ reacnetgenerator --type dump -i dump.reaxc -a C H O --nohmm
where C, H, and O are atomic names in the input file. Analysis report
will be generated automatically.

Also, ReacNetGenerator can process files containing bond information, 
e.g. LAMMPS bond file:
$ reacnetgenerator --type bond -i bonds.reaxc -a C H O --nohmm

You can running the following script for help:
$ reacnetgenerator -h

2022-11-05 08:51:46,154 - ReacNetGenerator 1.6.6.dev24+g068dac4 - INFO: Version: 1.6.6.dev24+g068dac4  Creation date: 2018-03-11

Read bond information and Detect molecules: 0timestep [00:00, ?timestep/s]
Read bond information and Detect molecules: 2timestep [00:01,  1.40timestep/s]
Read bond information and Detect molecules: 101timestep [00:01, 70.84timestep/s]

Save molecules:   0%|          | 0/11 [00:00&lt;?, ?molecule/s]
Save molecules: 100%|██████████| 11/11 [00:00&lt;00:00, 3376.31molecule/s]
2022-11-05 08:51:47,881 - ReacNetGenerator 1.6.6.dev24+g068dac4 - INFO: Step 1: Done! Time consumed (s): 1.726 (Read bond information and detect molecules)
2022-11-05 08:51:47,941 - ReacNetGenerator 1.6.6.dev24+g068dac4 - INFO: Step 2: Done! Time consumed (s): 0.060 (Merge isomers)

HMM filter: 0molecule [00:00, ?molecule/s]
HMM filter: 11molecule [00:00, 2628.61molecule/s]
2022-11-05 08:51:48,139 - ReacNetGenerator 1.6.6.dev24+g068dac4 - INFO: Step 3: Done! Time consumed (s): 0.198 (HMM filter)

Indentify isomers:   0%|          | 0/11 [00:00&lt;?, ?molecule/s]
Indentify isomers: 100%|██████████| 11/11 [00:00&lt;00:00, 585.62molecule/s]

Analyze atoms:   0%|          | 0/11 [00:00&lt;?, ?molecule/s]
Analyze atoms: 100%|██████████| 11/11 [00:00&lt;00:00, 7775.08molecule/s]

Collect reaction paths:   0%|          | 0/288 [00:00&lt;?, ?atom/s]
Collect reaction paths: 100%|██████████| 288/288 [00:00&lt;00:00, 11114.42atom/s]

Analyze reactions (A+B-&gt;C+D):   0%|          | 0/100 [00:00&lt;?, ?timestep/s]
Analyze reactions (A+B-&gt;C+D): 100%|██████████| 100/100 [00:00&lt;00:00, 12790.24timestep/s]
2022-11-05 08:51:48,583 - ReacNetGenerator 1.6.6.dev24+g068dac4 - INFO: Step 4: Done! Time consumed (s): 0.444 (Indentify isomers and collect reaction paths)
2022-11-05 08:51:48,651 - ReacNetGenerator 1.6.6.dev24+g068dac4 - INFO: Step 5: Done! Time consumed (s): 0.068 (Reaction matrix generation)
2022-11-05 08:51:48,667 - ReacNetGenerator 1.6.6.dev24+g068dac4 - INFO: Species are:
2022-11-05 08:51:48,667 - ReacNetGenerator 1.6.6.dev24+g068dac4 - INFO: 1 [H]C12N(N(=O)=O)C3([H])N(N(=O)=O)C1([H])N(N(=O)=O)C1([H])N(N(=O)=O)C3([H])N(N(=O)=O)C1([H])N2N(=O)=O
2022-11-05 08:51:48,667 - ReacNetGenerator 1.6.6.dev24+g068dac4 - INFO: 2 [H]C12NC3([H])N(N(=O)=O)C1([H])N(N(=O)=O)C1([H])N(N(=O)=O)C3([H])N(N(=O)=O)C1([H])N2N(=O)=O
2022-11-05 08:51:48,667 - ReacNetGenerator 1.6.6.dev24+g068dac4 - INFO: 3 O=NO
2022-11-05 08:51:48,672 - ReacNetGenerator 1.6.6.dev24+g068dac4 - INFO: The position of the species in the network is:
2022-11-05 08:51:48,672 - ReacNetGenerator 1.6.6.dev24+g068dac4 - INFO: {1: array([-5.95629110e-05, -1.00129074e-04]), 2: array([-0.59480018, -0.99989987]), 3: array([0.59485974, 1.        ])}
2022-11-05 08:51:48,855 - ReacNetGenerator 1.6.6.dev24+g068dac4 - INFO: Step 6: Done! Time consumed (s): 0.204 (Draw reaction network)
2022-11-05 08:51:48,878 - ReacNetGenerator 1.6.6.dev24+g068dac4 - INFO: Report is generated. Please see cl20.lammpstrj.html for more details.
2022-11-05 08:51:48,942 - ReacNetGenerator 1.6.6.dev24+g068dac4 - INFO: Step 7: Done! Time consumed (s): 0.087 (Generate analysis report)
2022-11-05 08:51:48,942 - ReacNetGenerator 1.6.6.dev24+g068dac4 - INFO: ====== Summary ======
2022-11-05 08:51:48,942 - ReacNetGenerator 1.6.6.dev24+g068dac4 - INFO: Total time(s): 2.787 s
</pre></div> </div> </div> </div> <p>The results are shown in <code class="docutils literal notranslate"><span class=pre>cl20.lammpstrj.html</span></code>. In addition, we can view an overview of reactions in the trajectory in the command line:</p> <div class="cell docutils container"> <div class="cell_input docutils container"> <div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=o>%%</span><span class=n>bash</span>
<span class=n>cat</span> <span class=n>cl20</span><span class=o>.</span><span class=n>lammpstrj</span><span class=o>.</span><span class=n>reactionabcd</span>
</pre></div> </div> </div> <div class="cell_output docutils container"> <div class="output stream highlight-myst-ansi notranslate"><div class=highlight><pre><span></span>1 [H]C12N(N(=O)=O)C3([H])N(N(=O)=O)C1([H])N(N(=O)=O)C1([H])N(N(=O)=O)C3([H])N(N(=O)=O)C1([H])N2N(=O)=O-&gt;O=NO+[H]C12NC3([H])N(N(=O)=O)C1([H])N(N(=O)=O)C1([H])N(N(=O)=O)C3([H])N(N(=O)=O)C1([H])N2N(=O)=O
</pre></div> </div> </div> </div> <p>Here we can clearly see that the CL-20 molecule is decomposited into a nitrogen dioxide molecule.</p> </section> </article> <footer class=bd-footer-article> <!-- Previous / next buttons --> <div class=prev-next-area> <a class=left-prev id=prev-link href=install.html title="previous page"> <i class="fa-solid fa-angle-left"></i> <div class=prev-next-info> <p class=prev-next-subtitle>previous</p> <p class=prev-next-title>Tutorial: Installation</p> </div> </a> <a class=right-next id=next-link href=methane.html title="next page"> <div class=prev-next-info> <p class=prev-next-subtitle>next</p> <p class=prev-next-title>Simulation of the oxidation of methane</p> </div> <i class="fa-solid fa-angle-right"></i> </a> </div> </footer> </div> <div class="bd-sidebar-secondary bd-toc"> <div class=toc-item> <div id=searchbox></div> </div> <div class=toc-item> <div class="tocsection editthispage"> <a href=https://github.com/tongzhugroup/reacnetgenerator/edit/master/docs/tutorial/analysis.ipynb> <i class="fa-solid fa-pencil"></i> Edit this page </a> </div> </div> <div class=toc-item> <div class="tocsection sourcelink"> <a href=../_sources/tutorial/analysis.ipynb.txt> <i class="fa-solid fa-file-lines"></i> Show Source </a> </div> </div> </div> </div> <footer class=bd-footer-content> <div class=bd-footer-content__inner> </div> </footer> </main> </div> </div> <!-- Scripts loaded after <body> so the DOM is not blocked --> <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536"></script> <footer class=bd-footer><div class="bd-footer__inner container"> <div class=footer-item> <p class=copyright> &copy; Copyright 2019-2022, East China Normal University.<br> </p> </div> <div class=footer-item> <p class=sphinx-version> Created using <a href=http://sphinx-doc.org/ >Sphinx</a> 5.3.0.<br> </p> </div> </div> </footer> </body> </html>