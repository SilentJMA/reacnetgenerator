<!DOCTYPE html><html lang=en> <head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0"><title>reacnetgenerator.tools &#8212; ReacNetGenerator documentation</title><script data-cfasync=false>
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script><!-- Loaded before other Sphinx assets --><link href="../../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel=stylesheet><link href="../../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel=stylesheet><link href="../../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel=stylesheet><link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel=stylesheet><link rel=preload as=font type=font/woff2 crossorigin href=../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2><link rel=preload as=font type=font/woff2 crossorigin href=../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2><link rel=preload as=font type=font/woff2 crossorigin href=../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2><link rel=stylesheet type=text/css href=../../_static/pygments.css><link rel=stylesheet type=text/css href=../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css><link rel=stylesheet type=text/css href=../../_static/css/custom.css><!-- Pre-loaded scripts that we'll load fully later --><link rel=preload as=script href="../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"><link rel=preload as=script href="../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"><script data-url_root=../../ id=documentation_options src=../../_static/documentation_options.js></script><script src=../../_static/jquery.js></script><script src=../../_static/underscore.js></script><script src=../../_static/_sphinx_javascript_frameworks_compat.js></script><script src=../../_static/doctools.js></script><script src=../../_static/sphinx_highlight.js></script><script>DOCUMENTATION_OPTIONS.pagename = '_modules/reacnetgenerator/tools';</script><script src=https://unpkg.com/bilitube@0/dist/bilitube.min.js></script><link rel=index title=Index href=../../genindex.html><link rel=search title=Search href=../../search.html><meta name=viewport content="width=device-width, initial-scale=1"><meta name=docsearch:language content=en></head> <body data-spy=scroll data-target=#bd-toc-nav data-offset=180 data-default-mode> <a class=skip-link href=#main-content>Skip to main content</a> <input type=checkbox class=sidebar-toggle name=__primary id=__primary> <label class="overlay overlay-primary" for=__primary></label> <input type=checkbox class=sidebar-toggle name=__secondary id=__secondary> <label class="overlay overlay-secondary" for=__secondary></label> <div class=search-button__wrapper> <div class=search-button__overlay></div> <div class=search-button__search-container> <form class="bd-search d-flex align-items-center" action=../../search.html method=get> <i class="fa-solid fa-magnifying-glass"></i> <input type=search class=form-control name=q id=search-input placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete=off autocorrect=off autocapitalize=off spellcheck=false> <span class=search-button__kbd-shortcut><kbd class=kbd-shortcut__modifier>Ctrl</kbd>+<kbd>K</kbd></span> </form> </div> </div> <nav class="bd-header navbar navbar-expand-lg bd-navbar" id=navbar-main><div class="bd-header__inner bd-page-width"> <label class="sidebar-toggle primary-toggle" for=__primary> <span class="fa-solid fa-bars"></span> </label> <div id=navbar-start> <a class="navbar-brand logo" href=../../index.html> <img src=../../_static/reacnetgen.svg class="logo__image only-light" alt=ReacNetGenerator> <img src=../../_static/reacnetgen.svg class="logo__image only-dark" alt=ReacNetGenerator> <p class="title logo__title">ReacNetGenerator</p> </a> </div> <div class="col-lg-9 navbar-header-items"> <div id=navbar-center class=mr-auto> <div class=navbar-center-item> <nav class=navbar-nav> <p class=sidebar-header-items__title role=heading aria-level=1 aria-label="Site Navigation"> Site Navigation </p> <ul id=navbar-main-elements class=navbar-nav> <li class=nav-item> <a class="nav-link nav-internal" href=../../guide/index.html> User Guide </a> </li> <li class=nav-item> <a class="nav-link nav-internal" href=../../tutorial/index.html> Examples </a> </li> <li class=nav-item> <a class="nav-link nav-internal" href=../../develop.html> Development </a> </li> <li class=nav-item> <a class="nav-link nav-internal" href=../../external.html> More </a> </li> <li class=nav-item> <a class="nav-link nav-external" href=/report.html> Report Loader </a> </li> </ul> </nav> </div> </div> <div id=navbar-end> <div class="navbar-end-item navbar-persistent--container"> <button class="btn btn-sm navbar-btn search-button search-button__button" title=Search aria-label=Search data-toggle=tooltip> <i class="fa-solid fa-magnifying-glass"></i> </button> </div> <div class=navbar-end-item> <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title=light/dark aria-label=light/dark data-toggle=tooltip> <span class=theme-switch data-mode=light><i class="fa-solid fa-sun"></i></span> <span class=theme-switch data-mode=dark><i class="fa-solid fa-moon"></i></span> <span class=theme-switch data-mode=auto><i class="fa-solid fa-circle-half-stroke"></i></span> </button> </div> <div class=navbar-end-item> <ul id=navbar-icon-links class=navbar-nav aria-label="Icon Links"> <li class=nav-item> <a href=https://github.com/tongzhugroup/reacnetgenerator title=GitHub class=nav-link rel=noopener target=_blank data-toggle=tooltip><span><i class="fa-brands fa-square-github"></i></span> <label class=sr-only>GitHub</label></a> </li> <li class=nav-item> <a href=https://doi.org/10.1039/C9CP05091D title=Paper class=nav-link rel=noopener target=_blank data-toggle=tooltip><span><i class="fa-solid fa-book-open"></i></span> <label class=sr-only>Paper</label></a> </li> </ul> </div> </div> </div> <div class=navbar-persistent--mobile> <button class="btn btn-sm navbar-btn search-button search-button__button" title=Search aria-label=Search data-toggle=tooltip> <i class="fa-solid fa-magnifying-glass"></i> </button> </div> <label class="sidebar-toggle secondary-toggle" for=__secondary> <span class="fa-solid fa-outdent"></span> </label> </div> </nav> <div class=bd-container> <div class="bd-container__inner bd-page-width"> <div class="bd-sidebar-primary bd-sidebar hide-on-wide"> <div class="sidebar-header-items sidebar-primary__section"> <div class=sidebar-header-items__center> <div class=navbar-center-item> <nav class=navbar-nav> <p class=sidebar-header-items__title role=heading aria-level=1 aria-label="Site Navigation"> Site Navigation </p> <ul id=navbar-main-elements class=navbar-nav> <li class=nav-item> <a class="nav-link nav-internal" href=../../guide/index.html> User Guide </a> </li> <li class=nav-item> <a class="nav-link nav-internal" href=../../tutorial/index.html> Examples </a> </li> <li class=nav-item> <a class="nav-link nav-internal" href=../../develop.html> Development </a> </li> <li class=nav-item> <a class="nav-link nav-internal" href=../../external.html> More </a> </li> <li class=nav-item> <a class="nav-link nav-external" href=/report.html> Report Loader </a> </li> </ul> </nav> </div> </div> <div class=sidebar-header-items__end> <div class=navbar-end-item> <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title=light/dark aria-label=light/dark data-toggle=tooltip> <span class=theme-switch data-mode=light><i class="fa-solid fa-sun"></i></span> <span class=theme-switch data-mode=dark><i class="fa-solid fa-moon"></i></span> <span class=theme-switch data-mode=auto><i class="fa-solid fa-circle-half-stroke"></i></span> </button> </div> <div class=navbar-end-item> <ul id=navbar-icon-links class=navbar-nav aria-label="Icon Links"> <li class=nav-item> <a href=https://github.com/tongzhugroup/reacnetgenerator title=GitHub class=nav-link rel=noopener target=_blank data-toggle=tooltip><span><i class="fa-brands fa-square-github"></i></span> <label class=sr-only>GitHub</label></a> </li> <li class=nav-item> <a href=https://doi.org/10.1039/C9CP05091D title=Paper class=nav-link rel=noopener target=_blank data-toggle=tooltip><span><i class="fa-solid fa-book-open"></i></span> <label class=sr-only>Paper</label></a> </li> </ul> </div> </div> </div> <div class="sidebar-end-items sidebar-primary__section"> <div class=sidebar-end-items__item> </div> </div> <div id=rtd-footer-container></div> </div> <main id=main-content class=bd-main> <div class=bd-content> <div class=bd-article-container> <div class=bd-header-article> </div> <article class=bd-article role=main> <h1>Source code for reacnetgenerator.tools</h1><div class=highlight><pre>
<span></span><span class=sd>&quot;&quot;&quot;Useful methods to futhur process ReacNetGenerator results.&quot;&quot;&quot;</span>
<span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>defaultdict</span>
<span class=kn>from</span> <span class=nn>pathlib</span> <span class=kn>import</span> <span class=n>Path</span>
<span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Tuple</span><span class=p>,</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>List</span><span class=p>,</span> <span class=n>Union</span>
<span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>Counter</span>

<span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=kn>import</span> <span class=nn>ase</span>


<div class=viewcode-block id=read_species><a class=viewcode-back href=../../api/reacnetgenerator.html#reacnetgenerator.tools.read_species>[docs]</a><span class=k>def</span> <span class=nf>read_species</span><span class=p>(</span><span class=n>specfile</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]]:</span>
    <span class=sd>&quot;&quot;&quot;Read species from the species file (ends with .species).</span>

<span class=sd>    For accuracy, HMM filter should be disabled.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    specfile : str or Path</span>
<span class=sd>        The species file.</span>

<span class=sd>    Returns</span>
<span class=sd>    -------</span>
<span class=sd>    step_idx : np.ndarray</span>
<span class=sd>        The index of the step.</span>
<span class=sd>    n_species : Dict[str, np.ndarray]</span>
<span class=sd>        The number of species in each step. The dict key is the species SMILES.</span>

<span class=sd>    Examples</span>
<span class=sd>    --------</span>
<span class=sd>    Plot the number of methane in each step.</span>

<span class=sd>    &gt;&gt;&gt; from reacnetgenerator.tools import read_species</span>
<span class=sd>    &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class=sd>    &gt;&gt;&gt; step_idx, n_species = read_species(&#39;methane.species&#39;)</span>
<span class=sd>    &gt;&gt;&gt; plt.plot(step_idx, n_species[&#39;[H]C([H])([H])[H]&#39;])</span>
<span class=sd>    &gt;&gt;&gt; plt.savefig(&quot;methane.svg&quot;)</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>step_idx</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>n_species</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=k>lambda</span><span class=p>:</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>int</span><span class=p>))</span>
    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>specfile</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
        <span class=n>ii</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span>
        <span class=k>for</span> <span class=n>ii</span><span class=p>,</span> <span class=n>line</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>f</span><span class=p>):</span>
            <span class=n>s</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>split</span><span class=p>()</span>
            <span class=n>step_idx</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>strip</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>)))</span>
            <span class=k>for</span> <span class=n>ss</span><span class=p>,</span> <span class=n>nn</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=mi>2</span><span class=p>::</span><span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>s</span><span class=p>[</span><span class=mi>3</span><span class=p>::</span><span class=mi>2</span><span class=p>]]):</span>
                <span class=n>n_species</span><span class=p>[</span><span class=n>ss</span><span class=p>][</span><span class=n>ii</span><span class=p>]</span> <span class=o>=</span> <span class=n>nn</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>nsteps</span> <span class=o>=</span> <span class=n>ii</span> <span class=o>+</span> <span class=mi>1</span>
    <span class=n>n_species2</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=k>for</span> <span class=n>ss</span> <span class=ow>in</span> <span class=n>n_species</span><span class=p>:</span>
        <span class=n>n_species2</span><span class=p>[</span><span class=n>ss</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>n_species</span><span class=p>[</span><span class=n>ss</span><span class=p>][</span><span class=n>ii</span><span class=p>]</span> <span class=k>for</span> <span class=n>ii</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>nsteps</span><span class=p>)],</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>step_idx</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>),</span> <span class=n>n_species2</span></div>


<div class=viewcode-block id=read_reactions><a class=viewcode-back href=../../api/reacnetgenerator.html#reacnetgenerator.tools.read_reactions>[docs]</a><span class=k>def</span> <span class=nf>read_reactions</span><span class=p>(</span><span class=n>reacfile</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=n>Counter</span><span class=p>,</span> <span class=nb>str</span><span class=p>]]:</span>
    <span class=sd>&quot;&quot;&quot;Read reactions from the reactions file (ends with .reaction or .reactionsabcd).</span>

<span class=sd>    For accuracy, HMM filter should be disabled.</span>
<span class=sd>    </span>
<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    reacfile : str or Path</span>
<span class=sd>        The reactions file.</span>

<span class=sd>    Returns</span>
<span class=sd>    -------</span>
<span class=sd>    occs : List[Tuple[int, Counter, str]]</span>
<span class=sd>        The number of occurences of each reaction. The tuple is (occurence, counter_reactants, reaction).</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>occs</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>reacfile</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>f</span><span class=p>:</span>
            <span class=n>s</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>split</span><span class=p>()</span>
            <span class=n>occs</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=nb>int</span><span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]),</span> <span class=n>Counter</span><span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;-&gt;&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;+&#39;</span><span class=p>)),</span> <span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span>
    <span class=k>return</span> <span class=n>occs</span></div>


<div class=viewcode-block id=calculate_rate><a class=viewcode-back href=../../api/reacnetgenerator.html#reacnetgenerator.tools.calculate_rate>[docs]</a><span class=k>def</span> <span class=nf>calculate_rate</span><span class=p>(</span><span class=n>specfile</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>],</span> <span class=n>reacfile</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>],</span> <span class=n>cell</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>timestep</span><span class=p>:</span> <span class=nb>float</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
    <span class=sd>&quot;&quot;&quot;Calculate the rate constant of each reaction.</span>

<span class=sd>    The rate constants are calculated by the method developed in [1]_.</span>
<span class=sd>    The time interval of the trajectory is assumed to be uniform.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    specfile : str</span>
<span class=sd>        The species file.</span>
<span class=sd>    reacfile : str</span>
<span class=sd>        The reactions file.</span>
<span class=sd>    cell : np.ndarray</span>
<span class=sd>        The cell with the shape (3, 3). Unit: Angstrom.</span>
<span class=sd>    timestep : float</span>
<span class=sd>        The time step. Unit: femtosecond.</span>

<span class=sd>    Returns</span>
<span class=sd>    -------</span>
<span class=sd>    rates : Dict[str, float]</span>
<span class=sd>        The rate of each reaction. The dict key is the reaction SMILES.</span>
<span class=sd>        The value is in unit of [(cm^3/mol)^(n-1)s^(-1)], where n is the reaction order.</span>

<span class=sd>    References</span>
<span class=sd>    ----------</span>
<span class=sd>    .. [1] Yanze Wu, Huai Sun, Liang Wu, Joshua D. Deetz, Extracting the mechanisms</span>
<span class=sd>       and kinetic models of complex reactions from atomistic simulation data, J.</span>
<span class=sd>       Comput. Chem. 40, 16, 1586-1592.</span>

<span class=sd>    Examples</span>
<span class=sd>    --------</span>
<span class=sd>    &gt;&gt;&gt; cell = np.eye(3) * 3.7601e1 # in unit Angstrom</span>
<span class=sd>    &gt;&gt;&gt; timestep = 0.1 # in unit fs</span>
<span class=sd>    &gt;&gt;&gt; rates = calculate_rate(&#39;methane.species&#39;, &#39;methane.reactionabcd&#39;, cell, timestep)</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>ase_cell</span> <span class=o>=</span> <span class=n>ase</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>Cell</span><span class=p>(</span><span class=n>cell</span><span class=p>)</span>
    
    <span class=n>timestep</span> <span class=o>*=</span> <span class=mi>10</span><span class=o>**-</span><span class=mi>15</span> <span class=c1># fs to s</span>
    <span class=c1>#N, step_tot =read_species(specfile)</span>
    <span class=n>step_idx</span><span class=p>,</span> <span class=n>n_species</span> <span class=o>=</span> <span class=n>read_species</span><span class=p>(</span><span class=n>specfile</span><span class=p>)</span>
    <span class=n>occs</span> <span class=o>=</span> <span class=n>read_reactions</span><span class=p>(</span><span class=n>reacfile</span><span class=p>)</span>

    <span class=c1># time interval between two frames</span>
    <span class=n>time_int</span> <span class=o>=</span> <span class=p>(</span><span class=n>step_idx</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>step_idx</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>*</span> <span class=n>timestep</span>
    <span class=c1># volume of the cell</span>
    <span class=n>volume</span> <span class=o>=</span> <span class=n>ase_cell</span><span class=o>.</span><span class=n>volume</span>
    <span class=n>volume</span> <span class=o>*=</span> <span class=mi>10</span><span class=o>**-</span><span class=mi>24</span> <span class=c1># Ang^3 to cm^3</span>
    <span class=n>volume_times_na</span> <span class=o>=</span> <span class=n>volume</span> <span class=o>*</span> <span class=n>ase</span><span class=o>.</span><span class=n>units</span><span class=o>.</span><span class=n>mol</span> <span class=c1># V * NA</span>
    
    <span class=n>rates</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=k>for</span> <span class=n>occ</span><span class=p>,</span> <span class=n>reacts</span><span class=p>,</span> <span class=n>reactions</span> <span class=ow>in</span> <span class=n>occs</span><span class=p>:</span>
        <span class=c1># k = occ_tot / ( V * time_tot * c_tot )</span>
        <span class=c1># c_tot = N_tot / (V * NA)</span>
        <span class=n>n_react</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>n_species</span><span class=p>[</span><span class=n>kk</span><span class=p>]</span> <span class=k>for</span> <span class=n>kk</span> <span class=ow>in</span> <span class=n>reacts</span><span class=o>.</span><span class=n>keys</span><span class=p>()])</span>
        <span class=n>nu</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=n>reacts</span><span class=o>.</span><span class=n>values</span><span class=p>()))</span>
        <span class=n>c_po</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span><span class=n>n_react</span> <span class=o>/</span> <span class=n>volume_times_na</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>repeat</span><span class=p>(</span><span class=n>nu</span><span class=p>,</span> <span class=n>n_react</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=n>n_react</span><span class=o>.</span><span class=n>shape</span><span class=p>))</span>
        <span class=n>c_tot</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>prod</span><span class=p>(</span><span class=n>c_po</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>))</span>
        <span class=n>k</span> <span class=o>=</span> <span class=n>occ</span> <span class=o>/</span> <span class=p>(</span><span class=n>volume_times_na</span> <span class=o>*</span> <span class=n>time_int</span> <span class=o>*</span> <span class=n>c_tot</span><span class=p>)</span>
        <span class=n>rates</span><span class=p>[</span><span class=n>reactions</span><span class=p>]</span> <span class=o>=</span> <span class=n>k</span>
    <span class=k>return</span> <span class=n>rates</span></div>
</pre></div> </article> <footer class=bd-footer-article> <!-- Previous / next buttons --> <div class=prev-next-area> </div> </footer> </div> <div class="bd-sidebar-secondary bd-toc"> <div class=toc-item> <div id=searchbox></div> </div> <div class=toc-item> </div> <div class=toc-item> </div> </div> </div> <footer class=bd-footer-content> <div class=bd-footer-content__inner> </div> </footer> </main> </div> </div> <!-- Scripts loaded after <body> so the DOM is not blocked --> <script src="../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script> <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script> <footer class=bd-footer><div class="bd-footer__inner container"> <div class=footer-item> <p class=copyright> &copy; Copyright 2019-2022, East China Normal University.<br> </p> </div> <div class=footer-item> <p class=theme-version> Built with the <a href=https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html> PyData Sphinx Theme </a> 0.12.0. </p> </div> <div class=footer-item> <p class=sphinx-version> Created using <a href=http://sphinx-doc.org/ >Sphinx</a> 5.3.0.<br> </p> </div> </div> </footer> </body> </html>